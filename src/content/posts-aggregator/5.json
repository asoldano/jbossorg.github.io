{
  "title": "Keycloak 22.0.2 released",
  "link": "https://www.keycloak.org/2023/09/keycloak-2202-released",
  "author": [
    {
      "name": null,
      "avatar": null
    }
  ],
  "date": "2023-09-11T00:00:00.000Z",
  "feed_title": "Keycloak Blog",
  "feed_avatar": "https://www.gravatar.com/avatar/87fe00619f08c241da8dfb23d907ffa2?s=50",
  "content": "To download the release go to .   RELEASE NOTES   SECURITY VULNERABILITY WHEN REGISTERING OR UPDATING USER THROUGH TEMPLATES  A security vulnerability was introduced in Keycloak 22.0.2. We highly recommend not upgrading to 22.0.2, and for anyone that has deployed 22.0.2 in production to upgrade to 22.0.3 immediately.  For users that has self-registered after Keycloak was upgraded to 22.0.2 their password is not stored securely, and can be exposed to administrators of Keycloak. This only affects users that has registered after the upgrade was rolled-out, and does not affect any previously registered users.  Any realm using the preview declarative user profile is not affected by this issue, and only realms using the default user profile provider is affected.  To identify if there are any affected users in your deployment you can query these by accessing the database, and running the following SQL statement:  SELECT DISTINCT U.ID, U.USERNAME, U.EMAIL, U.REALM_ID FROM USER_ENTITY U     INNER JOIN USER_ATTRIBUTE UA ON U.ID = UA.USER_ID     WHERE UA.NAME IN ('password','password-confirm')  We recommend contacting any affected users as well as adding the update password required action for them.  If there are any affected users we also recommend removing these attributes from the database by running the following SQL statement:  DELETE FROM USER_ATTRIBUTE UA WHERE UA.NAME IN ('password','password-confirm')  If any backups have been done of the database after the 22.0.2 release and there are affected users, we recommend deleting these.  CUSTOM USER STORAGE PROVIDERS  Any deployments with custom user storage federation providers may also be affected, please verify your custom user storage to identify if this is an issue.  To identify if there are any federated user affected in your deployment in case the user storage provider is delegating management of attributes to Keycloak, you can query these by accessing the database, and running the following SQL statement:  SELECT DISTINCT USER_ID,REALM_ID,STORAGE_PROVIDER_ID FROM FED_USER_ATTRIBUTE     WHERE NAME IN ('password','password-confirm')  If there are any affected federated users, we also recommend removing these attributes from the database by running the following SQL statement:  DELETE FROM FED_USER_ATTRIBUTE UA WHERE UA.NAME IN ('password','password-confirm')  If your custom user storage provider is managing attributes itself, you should look at your custom storage to remove the password and password-confirm attributes.   MIGRATION FROM 21.1  Before you upgrade remember to backup your database. If you are not on the previous release refer to for a complete list of migration changes.   A NEW PARAMETER FOR SPECIFY MAX LENGTH OF EMAIL LOCAL PART  A new parameter --spi-user-profile-declarative-user-profile-max-email-local-part-length is added to set max email local part length taking backwards compatibility into consideration. The default value is 64. Example of usage:  kc.[sh|bat] start --spi-user-profile-declarative-user-profile-max-email-local-part-length=100 ...   ALL RESOLVED ISSUES   ENHANCEMENTS   * Improve feature (detection) code in the Admin Console keycloak admin/api  * Remove bearer-only content from the Server Administration Guide keycloak docs  * Move email validation change docs to migration guide of 22.0.3 keycloak docs   BUGS   * Custom User Provider SPI: MULTIVALUED_STRING_TYPE value isn't correctly    displayed on ui (but correctly saved and retrieved) keycloak admin/ui  * Admin console throwing 403 error when logged in for sub realm using local    admin user keycloak admin/ui   UPGRADING  Before you upgrade remember to backup your database and check the for anything that may have changed."
}